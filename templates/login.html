{% extends 'app.html' %}
{% block content %}




<div class="container" >
  <h2 class="mt-5">Login</h2>

  <div class="row justify-content-center">
    <div class="col-md-6">

      {% with messages = get_flashed_messages() %}
      {% if messages %}
          <div class="alert alert-danger mb-3" role="alert">
              <ul>
                  {% for message in messages %}
                  <li>{{ message }}</li>
                  {% endfor %}
              </ul>
          </div>
      {% endif %}
      {% endwith %}

      <form action="/login" method="POST" id="loginForm">
        {{ form.hidden_tag() }}

        <div class="form-group">
          <label for="email" class="form-label">Email</label>
          {{ form.email(id="email", class="form-control", placeholder="Enter your email", required=True) }}

          {% if form.email.errors %}
            <ul class="text-danger">
              {% for error in form.email.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>

        <div class="form-group">
          <label for="password" class="form-label">Password</label>
          {{ form.password(id="password", class="form-control", placeholder="Enter your password", required=True) }}

          {% if form.password.errors %}
            <ul class="text-danger">
              {% for error in form.password.errors %}
                <li>{{ error }}</li>
              {% endfor %}
            </ul>
          {% endif %}
        </div>

        <button type="submit" class="btn btn-primary mt-3" id="submitButton">Login</button>
        <a href="/register" class="btn btn-secondary mt-3">Register</a>
      </form>

      <div id="loadingAnimation" class="mt-3" style="display: none;">
        <img src="/static/images/loading.gif" alt="Loading..." width="50" height="50">
      </div>
    </div>
  </div>
</div>


<!-- <script>
  // Handle form submission and feedback
  const loginForm = document.getElementById('loginForm');
  const loadingAnimation = document.getElementById('loadingAnimation');
  const submitButton = document.getElementById('submitButton');

  loginForm.addEventListener('submit', (event) => {
    event.preventDefault(); // Prevent default form submission

    // Show loading animation
    loadingAnimation.style.display = 'block';
    submitButton.disabled = true;
    submitButton.textContent = 'Logging in...';

    // Send the form data to the server (using AJAX)
    fetch('/login', {
      method: 'POST',
      body: new FormData(loginForm),
    })
    .then(response => {
      if (response.ok) {
        // Successful login, redirect to the dashboard or home page
        window.location.href = '/';
      } else {
        // Handle login errors (e.g., display an error message)
        response.json().then(data => {
          const errorMessage = data.message || 'An error occurred. Please try again later.';
          const alertDiv = document.createElement('div');
          alertDiv.classList.add('alert', 'alert-danger', 'mt-3');
          alertDiv.textContent = errorMessage;
          loginForm.parentNode.insertBefore(alertDiv, loginForm.nextSibling);
        });
      }
    })
    .catch(error => {
      // Handle network errors
      console.error('Error during login:', error);
      const alertDiv = document.createElement('div');
      alertDiv.classList.add('alert', 'alert-danger', 'mt-3');
      alertDiv.textContent = 'Network error. Please try again later.';
      loginForm.parentNode.insertBefore(alertDiv, loginForm.nextSibling);
    })
    .finally(() => {
      // Hide loading animation and re-enable submit button
      loadingAnimation.style.display = 'none';
      submitButton.disabled = false;
      submitButton.textContent = 'Login';
    });
  });

  // Real-time validation feedback
  const emailInput = document.getElementById('email');
  const passwordInput = document.getElementById('password');

  emailInput.addEventListener('input', () => {
    if (emailInput.validity.valid) {
      emailInput.classList.remove('is-invalid');
    } else {
      emailInput.classList.add('is-invalid');
    }
  });

  passwordInput.addEventListener('input', () => {
    if (passwordInput.validity.valid) {
      passwordInput.classList.remove('is-invalid');
    } else {
      passwordInput.classList.add('is-invalid');
    }
  });
</script> -->

{% endblock %}